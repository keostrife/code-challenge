{"version":3,"sources":["main.min.js"],"names":["_app","init","i","queryString","string","window","location","search","substr","split","data","pair","length","decodeURIComponent","replace","onload","App","country_search","apiUrl","form","document","querySelector","onsubmit","formHandler","value","maxPopulation","parseInt","updateHistory","history","pushState","pathname","e","preventDefault","s","alert","getAttribute","filter","item","population","query","page","pagination","fetch","apiURL","then","res","json","items","itemsPerPage","per_page","pageCount","total_pages","currentPage","render","renderResults","renderNav","resultHtml","renderItem","alpha3Code","name","altSpellings","join","area","capital","latlng","timezones","topLevelDomain","callingCodes","region","subregion","nativeName","languages","innerHTML","renderNavItem","current","JSON","parse","stringify","key","push","link","navHtml","prevBtn","nextBtn"],"mappings":"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","file":"main.min.js","sourcesContent":["{\r\n\tlet _app = {};\r\n\r\n\t_app.init = () => {\r\n\t\tfor(let i in _app) {\r\n\t\t\tif (_app[i].init) _app[i].init();\r\n\t\t}\r\n\t}\r\n\r\n\t_app.queryString = () => {\r\n\t\tlet string = window.location.search.substr(1).split('&');\r\n\t    if (string == \"\") return {};\r\n\t    let data = {};\r\n\t    for (let pair of string) {\r\n\t    \tpair=pair.split('=', 2);\r\n\t    \tif (pair.length == 1)\r\n\t    \t    data[pair[0]] = \"\";\r\n\t    \telse\r\n\t    \t    data[pair[0]] = decodeURIComponent(pair[1].replace(/\\+/g, \" \"));\r\n\t    }\r\n\t    return data;\r\n\t}\r\n\r\n\r\n\twindow.onload = ()=>{\r\n\t\t_app.init();\r\n\t}\r\n\r\n\twindow.App = _app;\r\n};App.country_search = {\r\n\tapiUrl: \"https://jsonmock.hackerrank.com/api/countries/search\",\r\n\tinit: () => {\r\n\t\tlet form = document.querySelector(\"#myForm\");\r\n\t\tlet queryString = App.queryString();\r\n\r\n\t\tform.onsubmit = App.country_search.formHandler;\r\n\r\n\t\t//if s is in query string search right away\r\n\t\tif(queryString[\"s\"]) {\r\n\t\t\tform.country_search.value = queryString[\"s\"];\r\n\t\t\tif(queryString[\"p\"]) maxPopulation = parseInt(queryString[\"p\"]);\r\n\t\t\tApp.country_search.search(queryString[\"s\"]);\r\n\t\t}\r\n\t},\r\n\tupdateHistory: (search)=>{\r\n\t\thistory.pushState({}, \"\", window.location.pathname+\"?s=\"+search);\r\n\t},\r\n\t//function declaration here to preserve this scope\r\n\tformHandler: function(e){\r\n\t\te.preventDefault();\r\n\t\tlet s = this.country_search.value || alert(this.getAttribute(\"data-errorMsg\"));\r\n\t\tif(s) App.country_search.search(s);\r\n\t},\r\n\tfilter: (item)=>{\r\n\t\treturn (item.population && item.population < maxPopulation);\r\n\t},\r\n\tsearch: (s)=>{\r\n\t\t//updating history\r\n\t\tlet query = App.queryString();\r\n\t\tlet page = query[\"page\"] || 1;\r\n\t\tif(query.s != s) {\r\n\t\t\tquery.s = s;\r\n\t\t\t//make sure pagination nav links have correct querystring\r\n\t\t\tApp.country_search.pagination.query = query;\r\n\t\t\tApp.country_search.updateHistory(s);\r\n\t\t}\r\n\r\n\t\t//this is equavilent of getCountries() function\r\n\t\treturn fetch(`${App.country_search.apiURL}?name=${s}&page=${page}`)\r\n\t\t\t.then((res)=>{return res.json()})\r\n\t\t\t.then((data)=>{\r\n\t\t\t\tlet pagination = App.country_search.pagination;\r\n\t\t\t\tpagination.items = data.data;\r\n\t\t\t\tpagination.itemsPerPage = data.per_page;\r\n\t\t\t\tpagination.pageCount = data.total_pages;\r\n\t\t\t\tpagination.currentPage = data.page;\r\n\t\t\t\tpagination.render();\r\n\t\t\t});\r\n\t},\r\n\tpagination: {\r\n\t\t//these values will get updated once the data is fetched\r\n\t\titems: [],\r\n\t\titemsPerPage: 10,\r\n\t\tcurrentPage: 1,\r\n\t\tpageCount: 1,\r\n\t\tquery: App.queryString(),\r\n\t\trender: ()=>{\r\n\t\t\t//render all results and nav into the page\r\n\t\t\tApp.country_search.pagination.renderResults();\r\n\t\t\tApp.country_search.pagination.renderNav();\r\n\t\t},\r\n\t\trenderResults: ()=>{\r\n\t\t\tlet resultHtml = \"\";\r\n\r\n\t\t\tlet renderItem = (item)=>{\r\n\t\t\t\tresultHtml += \"<li>\";\r\n\t\t\t\tresultHtml += `<a data-toggle=\"collapse\" href=\"#panel-${item.alpha3Code}\" role=\"button\" aria-expanded=\"false\" aria-controls=\"panel-${item.alpha3Code}\">${item.name}</a>`;\r\n\t\t\t\tresultHtml += `<div class=\"collapse\" id=\"panel-${item.alpha3Code}\">\r\n\t\t\t\t  <div class=\"card card-body\">\r\n\t\t\t\t    Alternative Spellings: ${item.altSpellings.join(', ')} <br>\r\n\t\t\t\t    Area: ${item.area} (sq. km) <br>\r\n\t\t\t\t    Capital: ${item.capital} <br>\r\n\t\t\t\t    Lat and Lng: ${item.latlng.join(\", \")} <br>\r\n\t\t\t\t    Name: ${item.name} <br>\r\n\t\t\t\t    Population: ${item.population} <br>\r\n\t\t\t\t    Timezones: ${item.timezones.join(\", \")} <br>\r\n\t\t\t\t    Top Level Domain Name Extensions: ${item.topLevelDomain.join(\", \")} <br>\r\n\t\t\t\t    Calling Code: ${item.callingCodes.join(\", \")} <br>\r\n\t\t\t\t    Region: ${item.region} <br>\r\n\t\t\t\t    Subregion: ${item.subregion} <br>\r\n\t\t\t\t    Native Name: ${item.nativeName} <br>\r\n\t\t\t\t    Languages: ${item.languages.join(\", \")} \r\n\t\t\t\t  </div>\r\n\t\t\t\t</div>`;\r\n\t\t\t\tresultHtml += \"</li>\";\r\n\r\n\t\t\t\treturn resultHtml;\r\n\t\t\t}\r\n\r\n\t\t\tfor(let item of App.country_search.pagination.items) {\r\n\t\t\t\t//filter the items\r\n\t\t\t\tif(!App.country_search.filter(item)) continue;\r\n\r\n\t\t\t\t//render html\r\n\t\t\t\tdocument.querySelector(\"#searchResults\").innerHTML  = renderItem(item);\r\n\t\t\t}\r\n\t\t},\r\n\t\trenderNav: ()=>{\r\n\t\t\tlet renderNavItem = (page)=>{\r\n\t\t\t\tlet current = '';\r\n\r\n\t\t\t\t//maintain the current querystring for nav links\r\n\t\t\t\tlet query = JSON.parse(JSON.stringify(App.country_search.pagination.query));\r\n\t\t\t\tquery.page = parseInt(page);\r\n\t\t\t\tif(page==\"previous\") query.page = parseInt(App.country_search.pagination.currentPage)-1;\r\n\t\t\t\tif(page==\"next\") query.page = parseInt(App.country_search.pagination.currentPage)+1;\r\n\t\t\t\tlet queryString = [];\r\n\t\t\t\tfor(let key in query) {\r\n\t\t\t\t\tqueryString.push(key+\"=\"+query[key]);\r\n\t\t\t\t}\r\n\t\t\t\tlet link = window.location.pathname+\"?\"+queryString.join(\"&\");\r\n\r\n\t\t\t\t//add current class\r\n\t\t\t\tif(parseInt(page) == App.country_search.pagination.currentPage) {\r\n\t\t\t\t\tcurrent = ' active';\r\n\t\t\t\t\tlink = '#';\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn `<li class=\"page-item${current}\"><a class=\"page-link\" href=\"${link}\">${page}</a></li>`;\r\n\t\t\t}\r\n\r\n\r\n\t\t\tlet navHtml = '';\r\n\t\t\tlet prevBtn = renderNavItem(\"previous\");\r\n\t\t\tlet nextBtn = renderNavItem(\"next\");\r\n\r\n\t\t\t//remove previous/next button if necessary\r\n\t\t\tif(App.country_search.pagination.currentPage == 1) prevBtn = '';\r\n\t\t\tif(App.country_search.pagination.currentPage == App.country_search.pagination.pageCount) nextBtn = '';\r\n\r\n\r\n\t\t\tnavHtml += prevBtn;\r\n\t\t\tif(App.country_search.pagination.pageCount > 1)\r\n\t\t\t\tfor(let page = 1; page <= App.country_search.pagination.pageCount; page++) {\r\n\t\t\t\t\tnavHtml += renderNavItem(page);\r\n\t\t\t\t}\r\n\t\t\tnavHtml += nextBtn;\r\n\r\n\t\t\tdocument.querySelector(\"#searchNav\").innerHTML  = navHtml;\r\n\t\t}\r\n\t}\r\n}"]}